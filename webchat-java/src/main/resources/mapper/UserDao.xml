<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="wow.kons.dao.UserDao">


    <cache eviction="FIFO"
            flushInterval="60000"
            size="512"
            readOnly="true"/>

    <select id="findUserById" resultType="user">
        SELECT p_id,p_account,p_password,p_name,p_sex
        FROM sys_person
        WHERE p_id=#{p_id}
    </select>

    <select id="loginCustom" resultType="user">
        SELECT p_name,p_sex,p_age
        FROM sys_person
        WHERE p_account=#{p_account}
        <if test="p_password != or p_password != ''">
            AND p_password=#{p_password}
        </if>
    </select>

    <insert id="registerCustom">
        INSERT INTO sys_person(p_name,p_account,p_password) VALUES (#{p_name},#{p_account},#{p_password});
        <selectKey resultType="int" keyProperty="p_id" order="AFTER">
            SELECT @@identity
        </selectKey>
    </insert>
</mapper>